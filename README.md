# SOYM_DiscordBot
身内用Discordサーバー専用Bot。~~結構無理矢理なソースコードだけど割としっかり動いてるから見逃してくれ~~

こちらのBotはWindowsでの利用を想定しているため、他の環境だと動作しない可能性がある。

## 機能・用途

- Twitterのオンゲキ公式アカウント([@ongeki_official](https://twitter.com/ongeki_official))からのツイートをリアルタイムで取得し、新曲追加に関するツイートのURLをDiscordの特定チャンネルに送信する。

## Botの動作に必要なもの
以下のものを準備し、同梱の`OAuthData.py`に書き込んでください。

- TwitterのBotとAPI、アクセストークン等
- DiscordのBotとトークン
- 送信対象のチャンネルのid

## ツイートの抽出条件
基本的には一つのツイートの本文に含まれているワードにて判定を行っている。

- `追加`というワードが含まれていた際、`新曲`もしくは`楽曲`というワードも同時に含まれていた場合。
- `一挙公開`というワードが含まれていた場合。
- `LUNATIC`というワードが含まれていた場合。

## 既知のバグ等

- 過去にオンゲキ公式アカウントからツイートされたことのある新曲追加ツイートにて、現状のコードだと抽出が不可能なツイートが存在する。
- 初回起動時、ログ出力先のディレクトリが見つからずエラーを吐く。(次バージョンにて修正予定)
  - 起動前に`main.py`と同じ階層に`logdump`ディレクトリを作成してください。

## 今後実装予定の機能
こちらに記載されているもの以外でも、要望があったものの中で実現可能なものは実装する。

- コマンド操作機能。コマンドを入力することでBotの設定を操作したりすることができるようにする「予定」。あくまで「予定」。
- `OAuthData.py`に未記入の項目があった場合はエラーをログに出力する機能

## 変更履歴
RC版などの細かなマイナーバージョンについては記載しない。

- **v1.0.0.211008**
  - 初版
- **v1.0.1.211021**

  主にログ出力機能のアップデート。

  - Bot起動時、古いログファイルがあった場合はリネームし、新しいログファイルに記録するようにした
  - Bot起動時、ログファイルにバージョンを記録するようにした
- **v1.0.2.211021**
  - 抽出条件に当てはまるツイートの中で、オンゲキ公式アカウント自身のリツイートも拾ってしまう問題を修正
- **v1.0.3.211101**
  - 抽出条件に関わらず、リツイート自体を無視するようにした
- **v1.0.4.211103**
  - v1.0.2.211021へのロールバックを実施(変更内容はv1.0.3.211101と同じ)
- **v1.0.5.211101**
  - Bot起動時、ウインドウタイトルを設定するようにした
  - Bot起動時、ログ出力先ディレクトリが存在しない場合作成するようにした
